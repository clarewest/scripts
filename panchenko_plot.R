library(ggplot2)
library(reshape)

m <- read.table("chunks.out")
names(m)<-c(1:(ncol(m)))
m<-m[-c(4:20),]
m[m==0]<- NA 
m2<-melt(m)


m<-as.matrix(m)

plot(names(m),m[1,],type='l',ylim=c(-120,0))
lines(c(1:ncol(m)),m[2,],type="l")
lines(c(1:ncol(m)),m[3,],type="l")
head(melt(m))
head(m)




t2<-read.table("1PIN.ss")
t2=t2[-seq(1:10),]
t<-read.table("1PIN_2_A.scores_final.txt")
PAN<-c(-76.157425, -78.1292, -75.156345, -75.87904999999999, -75.80875, -74.86355, -74.3911, -74.09755, -76.69565, -79.0961, -79.28169999999999, -82.8543, -83.34389999999999, -80.97699999999999, -82.0361, -82.7113, -83.33475, -83.838, -84.78784999999999, -83.63664999999999, -86.1877, -87.56195000000001, -87.34295, -87.7244, -85.99295000000001, -85.99295000000001, -85.99295000000001, -85.99295000000001, -85.99295000000001, -85.99295000000001, -85.99295000000001, -84.9364, -87.04405, -86.41345000000001, -85.74695, -85.52725, -86.12514999999999, -86.81290000000001, -86.21055000000001, -86.0833, -84.22425, -83.51495, -80.7993, -81.021, -82.14535000000001, -79.3968, -75.35315, -71.831, -71.8967, -73.88194999999999, -74.2487, -72.97435, -72.9039, -72.61455000000001, -73.10210000000001, -75.4354, -75.55765, -73.86545000000001, -71.88275, -72.2615, -72.78635, -73.32175000000001, -74.35825, -73.727, -75.87955, -76.053, -76.9354, -75.92229999999999, -75.25354999999999, -75.85645, -74.04849999999999, -72.5377, -75.02515, -72.6795, -72.4613, -74.59559999999999, -74.2841, -73.04265000000001, -71.54275, -73.2054, -72.929, -70.5144, -71.71225000000001, -72.8819, -73.53685, -73.45405, -74.30664999999999, -74.86695, -71.49345, -72.41195, -71.88555, -70.7496, -73.3297, -74.52435, -74.21825, -74.6605, -77.02325, -75.83005, -73.75935000000001, -75.61595, -75.2137, -74.33064999999999, -74.84405, -73.5073, -74.12495, -74.9123, -74.89269999999999, -74.92830000000001, -76.45875000000001, -76.3815, -75.7891, -77.29385, -76.93165, -77.50575, -77.9494, -77.706, -78.24985, -77.75085, -76.5453, -75.44485, -76.32535, -76.88765, -75.81435, -75.4476, -73.714145, -73.74608500000001, -74.39671, -75.529915, -76.8146, -76.554235, -76.49052, -76.336355, -76.489305, -76.91698000000001, -76.68117, -76.110613, -75.83736499999999, -81.39655, -80.60916999999999, -80.353015, -79.09304,NA)
t$V1<-t$V1+6
t3<-merge(t,t2,by="V1")
t3$V3<-PAN
pdf(file="~/StatsProject/1PIN_ss.pdf",width=7,height=4)
ggplot(t3, aes(t3$V1, t3$V2.x)) + 
  annotate("rect", xmin=40,xmax=44,ymin=-Inf,ymax=Inf,alpha=0.3,fill="gray") +
  geom_line(aes(group=1,colour=(t3$V2.y)), size=0.5) +
  geom_line(aes(x=t3$V1,y=t3$V3,colour=(t3$V2.y),group=1)) +
  geom_vline(xintercept=39,linetype="dashed") +  
  #  geom_line(aes(x=t3$V1,y=t3$foo,colour=(t3$V2.y),group=1)) +
  scale_x_continuous(breaks = seq(0,max(t3$V1),by = 10)) +
  scale_colour_discrete(name="Secondary \nStructure",
                        breaks=levels(t3$V2.y),
                        #                    values = c("maroon1","seashell4","deepskyblue1","darkgoldenrod1","seagreen3"),
                        labels=c("beta bridge", "coil", "bend","3_10 helix","alpha helix","bend","H-bonded helix")) + 
  #                    labels=c("beta", "coil", "helix","bend","helix turn")) + 
  theme_bw() + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),axis.text.x = element_text(size=6, angle=45)) +
  labs(x="Protein Length",y="SAINT2 Score",title="1T43")
dev.off()
